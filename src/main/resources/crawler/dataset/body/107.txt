javascript - Customer send a voicemail if user doesn't answer, in an incoming phone call - Stack Overflow Stack Overflow About Products For Teams Stack Overflow Public questions & answers Stack Overflow for Teams Where developers & technologists share private knowledge with coworkers Talent Build your employer brand Advertising Reach developers & technologists worldwide Labs The future of collective knowledge sharing About the company Loading… current community Stack Overflow help chat Meta Stack Overflow your communities Sign up or log in to customize your list. more stack exchange communities company blog Log in Sign up How are we doing? Please help us improve Twilio. Take our short survey Home Public Questions Tags Users Companies Collectives Collectives™ on Stack Overflow – Centralized & trusted content around the technologies you use the most. Learn more about Collectives Explore Collectives Teams Create free Team Collectives™ on Stack Overflow Find centralized, trusted content and collaborate around the technologies you use most. Learn more about Collectives Teams Q&A for work Connect and share knowledge within a single location that is structured and easy to search. Learn more about Teams Would you recommend Twilio? Take our short survey Customer send a voicemail if user doesn't answer, in an incoming phone call Ask Question Asked today Modified today Viewed 7 times Part of Twilio Collective 0 I am making an application where a user can buy a masked number and customer can contact that user via masked number. Now what I want to do is that when a customer calls a user's masked number, the call gets forwarded or redirected to his original number. I am doing it successfully But if the user is unreachable, busy or does not answers the phone, the customer should be able to record and send a voicemail to the user's masked number, which gets stored in our DB and we forward that voicemail to user's email using speech-to-text twilio API, I am using a ngrok webhook, which is already configured in our masked number using twilo console. I need some assistance in this regard . Here is my code just for reference const { getNumberWithoutUser, updateQuota } = require("../db/dbOperations");
const { sendMessageNotificationEmail } = require("../emailing/email");
const { sendSms, client } = require("../twilioFunctions");
const { appendMessage } = require("../db/messagingCollectionUtils");
const { appendCall } = require("../db/callsCollectionUtils");

const twilio = require("twilio");
const express = require("express");
const router = express.Router();
 router.post("/webhook/voice", async (req, res) => {
  const { To, From, CallStatus } = req.body;

  const [numbers] = await getNumberWithoutUser(To);
  if (!numbers) return res.status(400).send("User does not own this number");

  const type = numbers.numbers.subscriptions.find(
    (subscription) => subscription.active
  ).type;
  const isToPrimaryPhone =
    numbers?.numbers?.settings?.forwarding?.toPrimaryPhone;
  const primaryPhoneNumber =
    numbers?.numbers?.settings?.forwarding?.primaryPhoneNumber;
  console.log("CallStatus", CallStatus);

  if (isToPrimaryPhone) {
    switch (CallStatus) {
      case "ringing":
        // --> Add any welcome message (optional)
        const twiml = new twilio.twiml.VoiceResponse();
        // twiml.say("Petras Brinko Test message");
        twiml.dial(primaryPhoneNumber);
        await updateQuota(numbers._id, To, "callForwarding", type);
        res.type("text/xml");
        return res.send(twiml.toString());

      case "completed":
        await appendCall(numbers._id, To, From, req.body);
        return res.send("success");
    }
  }
  res.send("Call Forwarding is disabled or package has finished");
});
 I tried following TWILIO REST API documentation but got no relevant response javascript twilio voicemail Share Follow asked 13 mins ago Full Stack DevFull Stack Dev 1 New contributor Full Stack Dev is a new contributor to this site. Take care in asking for clarification, commenting, and answering. Check out our Code of Conduct. Add a comment | Related questions 0 How we can intergrate Qr code monkey api to an express.js backend 0 Send Voicemail to mobiles/landlines 0 How to send a voicemail for outbound calls in case of no-answer using Twilio Voice? Related questions 0 How we can intergrate Qr code monkey api to an express.js backend 0 Send Voicemail to mobiles/landlines 0 How to send a voicemail for outbound calls in case of no-answer using Twilio Voice? 4 How to determine the voicemail phone number in Android 2 how to answer incoming call in twilio API 8 Is there any way to detect if an Android phone supports Voicemail integration in the call log? 0 Prevent call from going to voicemail after after blocking it on Android Phone Load 4 more related questions Show fewer related questions 0 Sorted by: Reset to default Highest score (default) Trending (recent votes count more) Date modified (newest first) Date created (oldest first) Know someone who can answer? Share a link to this question via email, Twitter, or Facebook. Your Answer Full Stack Dev is a new contributor. Be nice, and check out our Code of Conduct. Thanks for contributing an answer to Stack Overflow! Please be sure to answer the question. Provide details and share your research! But avoid … Asking for help, clarification, or responding to other answers. Making statements based on opinion; back them up with references or personal experience. To learn more, see our tips on writing great answers. Draft saved Draft discarded Sign up or log in Sign up using Google Sign up using Facebook Sign up using Email and Password Submit Post as a guest Name Email Required, but never shown Post as a guest Name Email Required, but never shown Post Your Answer Discard By clicking “Post Your Answer”, you agree to our terms of service and acknowledge that you have read and understand our privacy policy and code of conduct. Browse other questions tagged javascript twilio voicemail or ask your own question. Twilio Collective See more This question is in a collective: a subcommunity defined by tags with relevant content and experts. The Overflow Blog Part man. Part machine. All farmer. Throwing away the script on testing (Ep. 583) Featured on Meta Statement from SO: June 5, 2023 Moderator Action Starting the Prompt Design Site: A New Home in our Stack Exchange Neighborhood Does the policy change for AI-generated content affect users who (want to)... Temporary policy: Generative AI (e.g., ChatGPT) is banned Hot Network Questions Safe to remove plastic chainring cover? C23 Vector Macro Implementation Are there countries where vehicles involved in an accident must move if they're blocking the flow of traffic? ImageWriter II occasionally prints hex dumps How to bevel curved objects with many sharp turns? Buffer accuracy in virtual layer differs from accuracy in PostGIS view Looking for a switch or circuit that resets when power is lost in a 12V application? Junior professorships (W1) in Germany - does the 6 year limit before start apply to all states? What minimum versions of operating systems and browsers are compatible with Google-managed SSL certificates? Compare new txt file with old txt file and remove all data that matches Proving the Replica Trick works Is this Order of Scribes wizard combo with the Elemental Bane and Faithful Hound spells a legal exploit? Why are Search & Rescue aircraft looking for the OceanGate Titan submarine not visible on ADS-B Exchange? If Boris Johnson returns as an MP, would he have to serve the 90-day suspension for lying to Parliament? Are passengers required to obey pilots' commands? How to compare loan interest rate to savings account interest rate? How does population size impact the precision of the results Is it possible to fill the second column with something automatically? Combine 1,3,3,7 to get 10 Film about people in a rural area trapped behind a force field Short story involving a future in which janitors run the world Vertices of a regular dodecahedron What are some monsters or spells that could trap NPCs for a long time without killing them? Is there a way to keep the versatile bonus while mounted, like a feat or anything? more hot questions Question feed Subscribe to RSS Question feed To subscribe to this RSS feed, copy and paste this URL into your RSS reader. lang-js Stack Overflow Questions Help Products Teams Advertising Collectives Talent Company About Press Work Here Legal Privacy Policy Terms of Service Contact Us Cookie Settings Cookie Policy Stack Exchange Network Technology Culture & recreation Life & arts Science Professional Business API Data Blog Facebook Twitter LinkedIn Instagram Site design / logo © 2023 Stack Exchange Inc; user contributions licensed under CC BY-SA. rev 2023.6.23.43507 Your privacy By clicking “Accept all cookies”, you agree Stack Exchange can store cookies on your device and disclose information in accordance with our Cookie Policy. Accept all cookies Necessary cookies only Customize settings